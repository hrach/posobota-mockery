<?php

use Kdyby\Curl\Response;
use Mockery\MockInterface;
use Skrasek\TalkMocking\MovieDownloader;
use Skrasek\TalkMocking\Person;
use Skrasek\TalkMocking\PersonsRepository;
use Tester\Assert;

require __DIR__ . '/../vendor/autoload.php';

$json = <<<JSON
{"id":263138,"year":2011,"poster_url":"http:\/\/img.csfd.cz\/files\/images\/film\/posters\/159\/448\/159448617_e0eac0.jpg?h180","names":{"cs":"Hra o tr\u016fny","en":"Game of Thrones"},"genres":["Fantasy","Drama","Dobrodru\u017en\u00fd"],"countries":["USA","Velk\u00e1 Brit\u00e1nie"],"rating":92,"plot":"Kontinent, kde l\u00e9ta trvaj\u00ed des\u00edtky rok\u016f a zimy se mohou prot\u00e1hnout na cel\u00fd lidsk\u00fd \u017eivot, za\u010d\u00ednaj\u00ed su\u017eovat nepokoje. V\u0161ech Sedm kr\u00e1lovstv\u00ed Z\u00e1padozem\u00ed - pletich\u00e1\u0159sk\u00fd jih, divok\u00e9 v\u00fdchodn\u00ed krajiny i ledov\u00fd sever ohrani\u010den\u00fd starobylou Zd\u00ed, kter\u00e1 chr\u00e1n\u00ed kr\u00e1lovstv\u00ed p\u0159ed pronik\u00e1n\u00edm temnoty - je zm\u00edt\u00e1no bojem dvou mocn\u00fdch rod\u016f na \u017eivot a na smrt o nadvl\u00e1du nad celou \u0159\u00ed\u0161\u00ed. Zem\u00ed ot\u0159\u00e1s\u00e1 zrada, cht\u00ed\u010d, intriky a nadp\u0159irozen\u00e9 s\u00edly. Krvav\u00fd boj o \u017delezn\u00fd tr\u016fn, post nejvy\u0161\u0161\u00edho vl\u00e1dce Sedmi kr\u00e1lovstv\u00ed, bude m\u00edt nep\u0159edv\u00eddateln\u00e9 a dalekos\u00e1hl\u00e9 d\u016fsledky... V\u00fdpravn\u00fd seri\u00e1l HBO Hra o tr\u016fny, podle bestsellerov\u00e9 fantasy s\u00e1gy P\u00edse\u0148 ohn\u011b a ledu od George R. R. Martina, zachycuje soupe\u0159en\u00ed o moc mezi kr\u00e1li a kr\u00e1lovnami, ryt\u00ed\u0159i a odpadl\u00edky, lh\u00e1\u0159i a \u0161lechtici. Na po\u010d\u00e1tku po\u017e\u00e1d\u00e1 kr\u00e1l Robert Baratheon, jeho\u017e \u017eena Cersei poch\u00e1z\u00ed z rodu bohat\u00fdch a bezohledn\u00fdch Lannister\u016f, lorda Eddarda Starka, aby p\u0159ijel na jih a pomohl mu spravovat kr\u00e1lovstv\u00ed pot\u00e9, co z\u00e1hadn\u011b skonal jeho pobo\u010dn\u00edk. Z\u00e1rove\u0148 tr\u016fn z v\u00fdchodu ohro\u017euje dosp\u00edvaj\u00edc\u00ed princezna Daenerys s bratrem Viserysem, jejich\u017e rod Targaryen\u016f vl\u00e1dl Z\u00e1padozem\u00ed mnoho let p\u0159edt\u00edm, ne\u017e byl krvav\u011b sesazen. A prosl\u00fdch\u00e1 se tak\u00e9, \u017ee se d\u011bj\u00ed podivn\u00e9 v\u011bci na hranic\u00edch, severn\u011b od Zdi, kam odj\u00ed\u017ed\u00ed Jon Snow, Ned\u016fv neman\u017eelsk\u00fd syn, aby se stal \u010dlenem bratrstva, jen\u017e je zav\u00e1z\u00e1no p\u0159\u00edsahou kr\u00e1lovstv\u00ed chr\u00e1nit.","runtime":"40x60 min","authors":{"directors":[{"id":49181,"name":"Brian Kirk","api_url":"\/author\/49181","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/49181"},{"id":4651,"name":"Daniel Minahan","api_url":"\/author\/4651","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/4651"},{"id":21271,"name":"Alan Taylor","api_url":"\/author\/21271","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/21271"},{"id":34815,"name":"Timothy Van Patten","api_url":"\/author\/34815","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/34815"},{"id":4720,"name":"Neil Marshall","api_url":"\/author\/4720","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/4720"},{"id":20681,"name":"David Petrarca","api_url":"\/author\/20681","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/20681"},{"id":86279,"name":"Alik Sakharov","api_url":"\/author\/86279","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/86279"},{"id":3025,"name":"David Nutter","api_url":"\/author\/3025","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/3025"},{"id":72636,"name":"David Benioff","api_url":"\/author\/72636","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/72636"},{"id":3758,"name":"Alex Graves","api_url":"\/author\/3758","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/3758"},{"id":27017,"name":"Michelle Maxwell MacLaren","api_url":"\/author\/27017","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/27017"},{"id":75976,"name":"D.B. Weiss","api_url":"\/author\/75976","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/75976"}],"original":[{"id":75975,"name":"George Raymond Richard Martin","api_url":"\/author\/75975","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/75975"}],"script":[{"id":72636,"name":"David Benioff","api_url":"\/author\/72636","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/72636"},{"id":75975,"name":"George Raymond Richard Martin","api_url":"\/author\/75975","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/75975"},{"id":75976,"name":"D.B. Weiss","api_url":"\/author\/75976","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/75976"},{"id":76301,"name":"Vanessa Taylor","api_url":"\/author\/76301","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/76301"},{"id":117992,"name":"Bryan Cogman","api_url":"\/author\/117992","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/117992"}],"camera":[{"id":78511,"name":"Jonathan Freeman","api_url":"\/author\/78511","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/78511"},{"id":80982,"name":"Sam McCurdy","api_url":"\/author\/80982","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/80982"},{"id":83058,"name":"Kramer Morgenthau","api_url":"\/author\/83058","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/83058"},{"id":102083,"name":"Matthew Jensen","api_url":"\/author\/102083","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/102083"},{"id":86279,"name":"Alik Sakharov","api_url":"\/author\/86279","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/86279"}],"soundtrack":[{"id":63446,"name":"Ramin Djawadi","api_url":"\/author\/63446","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/63446"}],"actors":[{"id":13613,"name":"Lena Headey","api_url":"\/author\/13613","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/13613"},{"id":4854,"name":"Peter Dinklage","api_url":"\/author\/4854","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/4854"},{"id":65873,"name":"Emilia Clarke","api_url":"\/author\/65873","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/65873"},{"id":35253,"name":"Nikolaj Coster-Waldau","api_url":"\/author\/35253","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/35253"},{"id":170,"name":"Sean Bean","api_url":"\/author\/170","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/170"},{"id":68576,"name":"Michelle Fairley","api_url":"\/author\/68576","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/68576"},{"id":6763,"name":"Mark Addy","api_url":"\/author\/6763","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/6763"},{"id":2532,"name":"Iain Glen","api_url":"\/author\/2532","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/2532"},{"id":7894,"name":"Julian Glover","api_url":"\/author\/7894","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/7894"},{"id":14815,"name":"Aidan Gillen","api_url":"\/author\/14815","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/14815"},{"id":9924,"name":"Ron Donachie","api_url":"\/author\/9924","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/9924"},{"id":63057,"name":"Rory McCann","api_url":"\/author\/63057","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/63057"},{"id":37288,"name":"Jason Momoa","api_url":"\/author\/37288","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/37288"},{"id":65872,"name":"Sophie Turner","api_url":"\/author\/65872","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/65872"},{"id":65871,"name":"Kit Harington","api_url":"\/author\/65871","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/65871"},{"id":67763,"name":"Richard Madden","api_url":"\/author\/67763","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/67763"},{"id":66037,"name":"Maisie Williams","api_url":"\/author\/66037","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/66037"},{"id":10809,"name":"Jamie Sives","api_url":"\/author\/10809","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/10809"},{"id":66030,"name":"Jerome Flynn","api_url":"\/author\/66030","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/66030"},{"id":53929,"name":"Donald Sumpter","api_url":"\/author\/53929","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/53929"},{"id":66033,"name":"John Bradley","api_url":"\/author\/66033","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/66033"},{"id":66031,"name":"Jack Gleeson","api_url":"\/author\/66031","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/66031"},{"id":66038,"name":"Isaac Hempstead-Wright","api_url":"\/author\/66038","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/66038"},{"id":25378,"name":"Natalie Dormer","api_url":"\/author\/25378","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/25378"},{"id":72863,"name":"Harry Lloyd","api_url":"\/author\/72863","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/72863"},{"id":71564,"name":"Rose Leslie","api_url":"\/author\/71564","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/71564"},{"id":261,"name":"Charles Dance","api_url":"\/author\/261","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/261"},{"id":78777,"name":"Alfie Allen","api_url":"\/author\/78777","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/78777"},{"id":33082,"name":"Natalia Tena","api_url":"\/author\/33082","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/33082"},{"id":52350,"name":"David Bradley","api_url":"\/author\/52350","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/52350"},{"id":48187,"name":"Roger Allam","api_url":"\/author\/48187","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/48187"},{"id":15934,"name":"Sibel Kekilli","api_url":"\/author\/15934","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/15934"},{"id":42262,"name":"Kate Dickie","api_url":"\/author\/42262","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/42262"},{"id":15101,"name":"James Cosmo","api_url":"\/author\/15101","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/15101"},{"id":12151,"name":"Peter Vaughan","api_url":"\/author\/12151","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/12151"},{"id":48990,"name":"Bronson Webb","api_url":"\/author\/48990","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/48990"},{"id":66034,"name":"Miltos Yerolemou","api_url":"\/author\/66034","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/66034"},{"id":68876,"name":"Owen Teale","api_url":"\/author\/68876","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/68876"},{"id":66039,"name":"Art Parkinson","api_url":"\/author\/66039","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/66039"},{"id":66474,"name":"Joseph Mawle","api_url":"\/author\/66474","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/66474"},{"id":67683,"name":"Roxanne McKee","api_url":"\/author\/67683","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/67683"},{"id":68159,"name":"Esm\u00e9 Bianco","api_url":"\/author\/68159","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/68159"},{"id":95589,"name":"Amrita Acharia","api_url":"\/author\/95589","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/95589"},{"id":68606,"name":"Conan Stevens","api_url":"\/author\/68606","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/68606"},{"id":70463,"name":"John Standing","api_url":"\/author\/70463","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/70463"},{"id":54269,"name":"Joe Dempsie","api_url":"\/author\/54269","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/54269"},{"id":59328,"name":"Robert Pugh","api_url":"\/author\/59328","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/59328"},{"id":28895,"name":"Carice van Houten","api_url":"\/author\/28895","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/28895"},{"id":6198,"name":"Liam Cunningham","api_url":"\/author\/6198","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/6198"},{"id":2506,"name":"Stephen Dillane","api_url":"\/author\/2506","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/2506"},{"id":77437,"name":"Emun Elliott","api_url":"\/author\/77437","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/77437"},{"id":35315,"name":"Patrick Malahide","api_url":"\/author\/35315","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/35315"},{"id":48740,"name":"Hannah Murray","api_url":"\/author\/48740","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/48740"},{"id":20347,"name":"Tom Wlaschiha","api_url":"\/author\/20347","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/20347"},{"id":50170,"name":"Nonso Anozie","api_url":"\/author\/50170","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/50170"},{"id":19977,"name":"Roy Dotrice","api_url":"\/author\/19977","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/19977"},{"id":78970,"name":"Gemma Whelan","api_url":"\/author\/78970","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/78970"},{"id":78971,"name":"Lucian Msamati","api_url":"\/author\/78971","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/78971"},{"id":78972,"name":"Gethin Anthony","api_url":"\/author\/78972","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/78972"},{"id":78973,"name":"Gwendoline Christie","api_url":"\/author\/78973","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/78973"},{"id":78974,"name":"Finn Jones","api_url":"\/author\/78974","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/78974"},{"id":39483,"name":"Oona Chaplin","api_url":"\/author\/39483","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/39483"},{"id":79463,"name":"Ian Whyte","api_url":"\/author\/79463","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/79463"},{"id":80808,"name":"Kristian Nairn","api_url":"\/author\/80808","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/80808"},{"id":33818,"name":"Mackenzie Crook","api_url":"\/author\/33818","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/33818"},{"id":34247,"name":"Thomas Brodie-Sangster","api_url":"\/author\/34247","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/34247"},{"id":83398,"name":"Anton Lesser","api_url":"\/author\/83398","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/83398"},{"id":83417,"name":"Kristina Krepela","api_url":"\/author\/83417","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/83417"},{"id":85063,"name":"Aimee Richardson","api_url":"\/author\/85063","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/85063"},{"id":85064,"name":"Nathalie Emmanuel","api_url":"\/author\/85064","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/85064"},{"id":85167,"name":"Antonia Christophers","api_url":"\/author\/85167","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/85167"},{"id":85169,"name":"Laura Pradelska","api_url":"\/author\/85169","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/85169"},{"id":87264,"name":"Elyes Gabel","api_url":"\/author\/87264","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/87264"},{"id":87305,"name":"Conleth Hill","api_url":"\/author\/87305","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/87305"},{"id":87333,"name":"Ben Crompton","api_url":"\/author\/87333","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/87333"},{"id":88012,"name":"Charlotte Hope","api_url":"\/author\/88012","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/88012"},{"id":88210,"name":"Eros Vlahos","api_url":"\/author\/88210","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/88210"},{"id":89354,"name":"Mia Soteriou","api_url":"\/author\/89354","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/89354"},{"id":89369,"name":"Luke Barnes","api_url":"\/author\/89369","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/89369"},{"id":80316,"name":"Kristofer Hivju","api_url":"\/author\/80316","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/80316"},{"id":89370,"name":"Mark Stanley","api_url":"\/author\/89370","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/89370"},{"id":89371,"name":"Callum Wharry","api_url":"\/author\/89371","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/89371"},{"id":65395,"name":"Lino Facioli","api_url":"\/author\/65395","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/65395"},{"id":89548,"name":"Ed Skrein","api_url":"\/author\/89548","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/89548"},{"id":89554,"name":"Ciaran Bermingham","api_url":"\/author\/89554","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/89554"},{"id":89555,"name":"Daniel Portman","api_url":"\/author\/89555","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/89555"},{"id":89556,"name":"Wilko Johnson","api_url":"\/author\/89556","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/89556"},{"id":89570,"name":"Dar Salim","api_url":"\/author\/89570","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/89570"},{"id":56298,"name":"Iwan Rheon","api_url":"\/author\/56298","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/56298"},{"id":11797,"name":"Ciar\u00e1n Hinds","api_url":"\/author\/11797","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/11797"},{"id":89565,"name":"Ian McElhinney","api_url":"\/author\/89565","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/89565"},{"id":4321,"name":"Diana Rigg","api_url":"\/author\/4321","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/4321"},{"id":23808,"name":"Paul Kaye","api_url":"\/author\/23808","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/23808"},{"id":79891,"name":"Richard Dormer","api_url":"\/author\/79891","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/79891"},{"id":18814,"name":"Noah Taylor","api_url":"\/author\/18814","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/18814"},{"id":70967,"name":"Ellie Kendrick","api_url":"\/author\/70967","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/70967"},{"id":93715,"name":"Michael McElhatton","api_url":"\/author\/93715","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/93715"},{"id":97784,"name":"Francis Magee","api_url":"\/author\/97784","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/97784"},{"id":103813,"name":"Alexandra Dowling","api_url":"\/author\/103813","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/103813"},{"id":104147,"name":"Elisa Lasowski","api_url":"\/author\/104147","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/104147"},{"id":112665,"name":"Jefferson Hall","api_url":"\/author\/112665","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/112665"},{"id":51913,"name":"Indira Varma","api_url":"\/author\/51913","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/51913"},{"id":543,"name":"Tara Fitzgerald","api_url":"\/author\/543","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/543"},{"id":59916,"name":"Jacob Anderson","api_url":"\/author\/59916","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/59916"},{"id":52066,"name":"Roger Ashton-Griffiths","api_url":"\/author\/52066","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/52066"},{"id":74591,"name":"Jon Thor Birgisson","api_url":"\/author\/74591","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/74591"},{"id":101766,"name":"Orri P. Dyrason","api_url":"\/author\/101766","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/101766"},{"id":18975,"name":"Sigur R\u00f3s","api_url":"\/author\/18975","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/18975"},{"id":113499,"name":"Philip McGinley","api_url":"\/author\/113499","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/113499"},{"id":114303,"name":"Clive Mantle","api_url":"\/author\/114303","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/114303"},{"id":114474,"name":"Pedro Pascal","api_url":"\/author\/114474","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/114474"},{"id":115467,"name":"Michiel Huisman","api_url":"\/author\/115467","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/115467"},{"id":115629,"name":"Tony Way","api_url":"\/author\/115629","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/115629"},{"id":115678,"name":"Struan Rodger","api_url":"\/author\/115678","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/115678"},{"id":20836,"name":"Mark Gatiss","api_url":"\/author\/20836","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/20836"},{"id":115794,"name":"Jurij Kolokolnikov","api_url":"\/author\/115794","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/115794"},{"id":52824,"name":"Burn Gorman","api_url":"\/author\/52824","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/52824"},{"id":58929,"name":"Tim Plester","api_url":"\/author\/58929","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/58929"},{"id":61088,"name":"George Georgiou","api_url":"\/author\/61088","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/61088"},{"id":117132,"name":"Kerry Ingram","api_url":"\/author\/117132","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/117132"},{"id":117946,"name":"Haf\u00fe\u00f3r J\u00fal\u00edus Bj\u00f6rnsson","api_url":"\/author\/117946","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/117946"},{"id":118468,"name":"Paola Dionisotti","api_url":"\/author\/118468","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/118468"},{"id":4720,"name":"Neil Marshall","api_url":"\/author\/4720","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/4720"},{"id":120067,"name":"Octavia Selena Alexandru","api_url":"\/author\/120067","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/120067"},{"id":120165,"name":"Dean-Charles Chapman","api_url":"\/author\/120165","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/120165"},{"id":120166,"name":"Neil Fingleton","api_url":"\/author\/120166","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/120166"},{"id":120167,"name":"Gerard Jordan","api_url":"\/author\/120167","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/120167"},{"id":120260,"name":"Josef Altin","api_url":"\/author\/120260","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/120260"},{"id":120265,"name":"Brennock O'Connor","api_url":"\/author\/120265","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/120265"},{"id":120947,"name":"Mark Lewis Jones","api_url":"\/author\/120947","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/120947"},{"id":122469,"name":"David Fynn","api_url":"\/author\/122469","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/122469"},{"id":39309,"name":"Bart the Bear","api_url":"\/author\/39309","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/39309"},{"id":127525,"name":"Joseph Gatt","api_url":"\/author\/127525","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/127525"},{"id":96611,"name":"Jessica Henwick","api_url":"\/author\/96611","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/96611"},{"id":128847,"name":"Ben Hawkey","api_url":"\/author\/128847","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/128847"},{"id":131740,"name":"Nell Tiger Free","api_url":"\/author\/131740","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/131740"},{"id":131741,"name":"Xena Avramadis","api_url":"\/author\/131741","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/131741"},{"id":131742,"name":"Gabrielle Dempsey","api_url":"\/author\/131742","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/131742"},{"id":131744,"name":"Amy Dawson","api_url":"\/author\/131744","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/131744"},{"id":131745,"name":"Jazzy De Lisser","api_url":"\/author\/131745","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/131745"},{"id":131747,"name":"Sarine Sofair","api_url":"\/author\/131747","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/131747"},{"id":135038,"name":"Karl Davies","api_url":"\/author\/135038","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/135038"},{"id":147641,"name":"Talitha Luke-Eardley","api_url":"\/author\/147641","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/147641"},{"id":158715,"name":"Matthew Scurfield","api_url":"\/author\/158715","csfd_url":"http:\/\/www.csfd.cz\/tvurce\/158715"}]},"api_url":"\/movie\/263138","csfd_url":"http:\/\/www.csfd.cz\/film\/263138"}
JSON;

$personRepository = Mockery::mock(PersonsRepository::class);
$personRepository->shouldReceive('getById')->with(49181)->once()->andReturnUsing(function($id) {
	$person = new Person();
	$person->id = 49181;
	$person->name = 'Brian Kirk';
	$person->url = 'http://www.csfd.cz/tvurce/49181';
	$person->isPersisted = TRUE;

	return $person;
});
$personRepository->shouldReceive('getById')->with(4651)->once()->andReturnUsing(function($id) {
	$person = new Person();
	$person->id = 4651;
	$person->name = 'Daniel Minahan';
	$person->url = 'http://www.csfd.cz/tvurce/4651';
	$person->isPersisted = TRUE;

	return $person;
});
$personRepository->shouldReceive('getById')->andReturnNull();

$response = Mockery::mock(Response::class);
$response->shouldReceive('isOk')->once()->andReturn(TRUE);
$response->shouldReceive('getResponse')->once()->andReturn($json);

/** @var MockInterface $movieDownloader */
$movieDownloader = Mockery::mock(MovieDownloader::class, [$personRepository])->makePartial()->shouldAllowMockingProtectedMethods();
$movieDownloader->shouldReceive('downloadJson')->with('http://csfdapi.cz/movie/263138')->once()->andReturn($response);

$movie = $movieDownloader->get(263138);

Assert::same(263138, $movie->id);
Assert::same(2011, $movie->year);

Assert::true(is_array($movie->genres));
Assert::same(3, count($movie->genres));
Assert::same('Dobrodružný', $movie->genres[2]->name);

Assert::same(6, count($movie->authorGroups));

Assert::true($movie->authorGroups[0]->persons[0]->isPersisted);
Assert::false($movie->authorGroups[0]->persons[3]->isPersisted);

// ...


Mockery::close();
